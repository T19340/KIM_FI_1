# FI운용1부 업무 자동화 코드

## 1. 일일매매내역 작성 및 전송

### 실행 조건
- `K:\부서 공유\FI운용1부\10. 개인별폴더\김현수\rawdata` 폴더에 `FOS82105_YYYYMMDD.xlsx` 파일 필요
- FOS82105 화면 진입 → 조회 → 우클릭 후 엑셀출력
- **주의사항**
  - KB사무수탁시스템은 저장 방식에 따라 형식이 달라지므로 주의
  - 당결 확정 이후 실행해야 당일 매매내역 제대로 출력
  - 트레이딩부 확정 지연시 82106→82105 데이터 이관 지연 가능

## 2. CD금리 PeerGroup

### 기능
- 머니마켓액티브ETF(구 9004H) 피어그룹 YTM 및 듀레이션 탐색 및 자동 저장

### 실행 조건
- 별도 준비사항 없음 (홈페이지 오류시 진입 불가)

### 저장 경로
- 시계열 자료: `K:\부서 공유\FI운용1부\머니마켓ETF\초단기ETF_PeerGroup.xlsx`

## 3. 4JM40 입출금

### 기능
- 국내투자지원부(구 펀드오퍼레이션부) KDB생명 운용지시서 이메일의 4JM40 펀드 입출금 내역 정리

### 설정 변경 필요
- Outlook 폴더명 변경 필요
  - 원본: `localoutlook` - `펀드오퍼레이션부` 폴더

### 주의사항
- 담당자 부재시 대직자 메일 양식 불일치로 오류 가능

## 4. 예금보험기금 매매내역

### 실행 조건
- 일일매매내역 매크로 실행 이후 실행되는 것을 가정
- `K:\부서 공유\FI운용1부\10. 개인별폴더\김현수\rawdata`에 `FOS82105_YYYYMMDD.xlsx` 파일 필요

### 설정 변경 필요
- Outlook 폴더명 변경 필요
  - 원본: `LocalOutlook` - `트레이딩` 폴더

### 저장 경로
- `K:\부서 공유\FI운용1부\일일매매내역\예금보험기금_매매내역_YYYYMMDD.xlsx`

## 5. 일임 설정해지내역 - KB손해보험

### 기능
- KB손해보험 설정해지 내역 분류 및 저장

### 저장 경로
- `K:\부서 공유\FI운용1부\일임설정해지\KB손해보험설정해지_{today_str}.xlsx`

### 설정 변경 필요
- 로컬 아웃룩 폴더명 변경 필요

## 6. 시가펀드 자금판 오전 저장

### 실행 조건
- RPA 자료 다운 완료 후 실행 (보통 8:10 이전)
- 미실행시 `K:\프로젝트\RPA\32.시가펀드 포트폴리오 자금판 작성` 당일자 폴더 확인
  - PMO, MOS, FOS rawdata 없으면 RPA실 연락

### 저장 경로
- 자금판: `K:\부서 공유\FI운용1부\01. 1팀 자금판`
- 내일자 참고파일: `K:\프로젝트\RPA\32.시가펀드 포트폴리오 자금판 작성\REF\참고`

## 7. 시가펀드 자금판 오후 저장

### 기능
- 내일자 자금판 작성용 참고파일 저장
- 오전 코드에 통합되어 있으나 자금판 형식 변경시 별도 실행

### 저장 경로
- `K:\프로젝트\RPA\32.시가펀드 포트폴리오 자금판 작성\REF\참고`

## 8. 본부 수탁고 업데이트

### 실행 순서
1. MOS2101 → 종합데이터 탭 → 펀드: FI운용본부 전체펀드 → 조회
2. F9 눌러 csv 파일로 `source_csv` 경로에 다운로드
3. `specified_date`에 날짜 입력 후 실행
4. `FI운용본부_수탁고양식.xlsb` MOS2101 시트 데이터 확인
5. BOS3218에서 FI운용본부 전체 펀드 조회 → BOS3218 시트 붙여넣기
6. BOS3218Update 매크로 실행 → 마지막 행 번호 입력
7. PivotTables_EoM 시트 A2, B2 셀에 직전/새 데이터 날짜 입력
8. VBA 매크로 실행: 피벗테이블 업데이트(2회) → 월말기준수탁고시트작성 → 월말기준수탁고저장

### 참고
- 7~8번 작업은 수동 처리 가능
